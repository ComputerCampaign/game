# 音乐可视化程序

这是一个基于Python的音乐可视化程序，能够将音频文件转换为动态视觉效果的视频。程序会根据音频的频率特征，生成具有动感的小球动画，并将音频和视频合成为最终的可视化作品。

## 功能特点

- 支持多种音频格式（mp3、wav、ogg）
- 实时频谱分析和可视化
- 动态小球效果，颜色和大小随音频频率变化
- 自动音视频合成
- 批量处理多个音频文件

## 目录结构

```
./
├── src/              # 源代码目录
│   ├── main.py       # 主程序
│   ├── utils/        # 工具函数
│   └── crawler/      # 爬虫模块
├── downloads/        # 音频文件输入目录
├── output/          # 视频文件输出目录
└── requirements.txt  # 项目依赖
```

## 环境要求

- Python 3.6+
- FFmpeg（用于音视频合成）

## 安装步骤

1. 克隆项目到本地

2. 安装FFmpeg
   ```bash
   # macOS (使用Homebrew)
   brew install ffmpeg
   ```

3. 安装Python依赖
   ```bash
   pip install -r requirements.txt
   ```

## 使用方法

1. 准备音频文件
   - 将要处理的音频文件（支持.mp3、.wav、.ogg格式）放入 `downloads` 目录

2. 运行程序
   ```bash
   cd src
   python main.py
   ```

3. 查看结果
   - 生成的视频文件将保存在 `output` 目录中
   - 输出视频格式为MP4，文件名与输入音频文件相同

## 可视化效果

- 窗口大小：800x600像素
- 黑色背景
- 10个动态小球，代表不同频率段
- 小球颜色和大小随音频频率强度变化
- 视频帧率：30fps

## 注意事项

1. 确保系统已正确安装FFmpeg，且可以在命令行中访问
2. 程序会自动创建所需的目录结构
3. 处理大文件时可能需要较长时间，请耐心等待
4. 确保有足够的磁盘空间存储生成的视频文件

## 依赖说明

主要的Python依赖包：
- pygame：用于图形界面和动画绘制
- numpy：用于数值计算和数组操作
- librosa：用于音频处理和频谱分析
- opencv-python：用于视频处理和编码

## 错误处理

程序包含完整的错误处理和日志记录机制：
- 音频文件加载失败
- 视频编码器初始化失败
- 帧处理错误
- 音视频合成失败

所有错误和警告信息都会记录在日志文件中，方便排查问题。